name: Release to Chrome Web Store

on:
  push:
    branches:
      - 'test/release-workflow-test'

jobs:
  release:
    runs-on: ubuntu-latest

    steps:
        - name: Checkout code
          uses: actions/checkout@v4

        - name: Set up Node.js
          uses: actions/setup-node@v4
          with:
              node-version: 18

        - name: Install pnpm
          uses: pnpm/action-setup@v2
          with:
            version: 10  # または、あなたのプロジェクトで使用している pnpm のバージョン

        - name: Install dependencies
          run: pnpm install --no-frozen-lockfile

        # 以下、元のワークフローの残りの部分...

        - name: Debug Git status
          run: git status

        - name: Run build step
          run: pnpm build

        - name: Debug build step
          run: ls -al

        - name: Run zip step
          run: pnpm zip

        # ... 残りのステップも同様に pnpm run に変更

        - name: Debug zip step
          run: ls -al

        - name: Create .env.submit
          run: echo "${{ secrets.ENV_SUBMIT }}" > .env.submit

        - name: Run dryrun script
          run: pnpm dryrun

        - name: Debug dryrun script
          run: ls -al

        - name: Run submit script
          run: pnpm submit

        - name: Debug submit script
          run: ls -al